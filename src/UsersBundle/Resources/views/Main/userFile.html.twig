{% extends "PublicBundle::Layouts/datatableLayout.html.twig" %}

{% block pageLevelPluginsStyle %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset(GLOBAL~'plugins/fancybox/source/jquery.fancybox.css') }}" type="text/css" />
    <link rel="stylesheet" href="{{ asset(GLOBAL~'plugins/jquery-file-upload/blueimp-gallery/blueimp-gallery.min.css') }}" type="text/css" />
    <link rel="stylesheet" href="{{ asset(GLOBAL~'plugins/jquery-file-upload/css/jquery.fileupload.css') }}" type="text/css" />
    <link rel="stylesheet" href="{{ asset(GLOBAL~'plugins/jquery-file-upload/css/jquery.fileupload-ui.css') }}" type="text/css" />

{% endblock %}

{% block content %}
    <div class="row">
        <div class="col-md-12">
            <div class="portlet box blue">
                <div class="portlet-title">
                    <div class="caption font-white">
                        <i class="iconfont icon-file font-white"></i>
                        <span class="caption-subject bold uppercase">我的文件</span>
                    </div>
                    <div class="actions">
                        <a href="#large" class="btn btn-default btn-sm" data-toggle="modal">
                            <i class="iconfont icon-upload"></i> 文件上传 </a>
                    </div>
                </div>
                <div class="portlet-body">
                    <table class="table table-striped table-hover order-column my-file-table">
                        <thead>
                            <tr>
                                <th style="width:50px !important;">ID</th>
                                <th style="width:300px !important;">文件名</th>
                                <th style="width:150px !important;">上传时间</th>
                                <th style="width:50px !important;">状态</th>
                                <th style="width:100px !important;">操作</th>
                                <th style="width:500px !important;">功能</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for file in goodsFiles %}
                            <tr>
                                <td>{{ file.id }}</td>
                                <td>{{ file.oldname }}</td>
                                <td>{{ file.uploadTime }}</td>
                                <td>
                                    {% if file.state == 'read' %}
                                        {% set state = 'success' %}
                                        {% set title = '已读' %}
                                    {% elseif file.state == 'unread' %}
                                        {% set state = 'warning' %}
                                        {% set title = '未读' %}
                                    {% elseif file.state == 'wrong' %}
                                        {% set state = 'danger' %}
                                        {% set title = '错误' %}
                                    {% endif %}
                                    <button type="button" class="btn btn-xs btn-{{ state }}">{{ title }}</button>
                                </td>
                                <td>
                                    <button type="button" class="btn btn-xs default red-stripe">删除</button>
                                    <button type="button" class="btn btn-xs default green-meadow-stripe">下载</button>
                                </td>
                                <td>
                                    {% for type in styleTypes %}
                                        <a href="#{{ type.route }}" class="btn btn-link">{{ type.title }}</a>
                                    {% endfor %}
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade bs-modal-lg" id="large" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                    <h4 class="modal-title">文件上传</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <form id="fileupload" action="{{ path('upload') }}" method="POST" enctype="multipart/form-data">
                                <div class="row fileupload-buttonbar">
                                    <div class="col-lg-7">
                                        <span class="btn green fileinput-button">
                                            <i class="iconfont icon-plus"></i>
                                            <span> 添加文件 </span>
                                            <input type="file" name="files[]" multiple=""> </span>
                                        <button type="submit" class="btn blue start">
                                            <i class="iconfont icon-upload"></i>
                                            <span> 开始上传 </span>
                                        </button>
                                        <button type="reset" class="btn warning cancel">
                                            <i class="iconfont icon-ban-circle"></i>
                                            <span> 取消上传 </span>
                                        </button>
                                        <button type="button" class="btn red delete">
                                            <i class="iconfont icon-trash"></i>
                                            <span> 删除 </span>
                                        </button>
                                        <input type="checkbox" class="toggle">
                                        <span class="fileupload-process"> </span>
                                    </div>
                                    <!-- The global progress information -->
                                    <div class="col-lg-5 fileupload-progress fade">
                                        <!-- The global progress bar -->
                                        <div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                                            <div class="progress-bar progress-bar-success" style="width:0%;"> </div>
                                        </div>
                                        <!-- The extended global progress information -->
                                        <div class="progress-extended"> &nbsp; </div>
                                    </div>
                                </div>
                                <!-- The table listing the files available for upload/download -->
                                <table role="presentation" class="table table-striped clearfix">
                                    <tbody class="files"> </tbody>
                                </table>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn dark btn-outline" data-dismiss="modal">关闭</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
{% endblock %}

{% block pageLevelPluginsScript %}
    {{ parent() }}
    <script src="{{ asset(GLOBAL~'plugins/fancybox/source/jquery.fancybox.pack.js') }}" type="text/javascript"></script>
    <script src="{{ asset(GLOBAL~'plugins/jquery-file-upload/js/vendor/jquery.ui.widget.js') }}" type="text/javascript"></script>
    <script src="{{ asset(GLOBAL~'plugins/jquery-file-upload/js/vendor/tmpl.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset(GLOBAL~'plugins/jquery-file-upload/js/vendor/load-image.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset(GLOBAL~'plugins/jquery-file-upload/js/vendor/canvas-to-blob.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset(GLOBAL~'plugins/jquery-file-upload/blueimp-gallery/jquery.blueimp-gallery.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset(GLOBAL~'plugins/jquery-file-upload/js/jquery.iframe-transport.js') }}" type="text/javascript"></script>
    <script src="{{ asset(GLOBAL~'plugins/jquery-file-upload/js/jquery.fileupload.js') }}" type="text/javascript"></script>
    <script src="{{ asset(GLOBAL~'plugins/jquery-file-upload/js/jquery.fileupload-process.js') }}" type="text/javascript"></script>
    <script src="{{ asset(GLOBAL~'plugins/jquery-file-upload/js/jquery.fileupload-image.js') }}" type="text/javascript"></script>
    <script src="{{ asset(GLOBAL~'plugins/jquery-file-upload/js/jquery.fileupload-audio.js') }}" type="text/javascript"></script>
    <script src="{{ asset(GLOBAL~'plugins/jquery-file-upload/js/jquery.fileupload-video.js') }}" type="text/javascript"></script>
    <script src="{{ asset(GLOBAL~'plugins/jquery-file-upload/js/jquery.fileupload-validate.js') }}" type="text/javascript"></script>
    <script src="{{ asset(GLOBAL~'plugins/jquery-file-upload/js/jquery.fileupload-ui.js') }}" type="text/javascript"></script>
{% endblock %}

{% block pageLevelScripts %}
    {#<script src="{{ asset(PAGES~'scripts/form-fileupload.js') }}" type="text/javascript"></script>#}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript">
        $(function(){
            datatable($('.my-file-table'));
        });
    </script>
{% endblock %}
